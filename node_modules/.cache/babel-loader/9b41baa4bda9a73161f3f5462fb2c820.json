{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\shrey\\\\Desktop\\\\reactproject\\\\Newsy\\\\src\\\\pages\\\\Link.js\";\nimport React from \"react\";\nimport firebase from \"../firebase\";\nimport { Plugins } from \"@capacitor/core\";\nimport UserContext from \"../contexts/UserContext\";\nimport { IonPage, IonContent, IonGrid, IonRow, IonCol, IonButton } from \"@ionic/react\";\nimport NavHeader from \"../components/Header/NavHeader\";\nimport { closeCircleOutline } from \"ionicons/icons\";\nimport LinkItem from \"../components/Link/LinkItem\";\nconst {\n  Browser\n} = Plugins;\n\nconst Link = props => {\n  const {\n    user\n  } = React.useContext(UserContext);\n  const [link, setLink] = React.useState(null);\n  const linkId = props.match.params.linkId;\n  const linkRef = firebase.db.collection(\"links\").doc(linkId);\n  React.useEffect(() => {\n    getLink(); // eslint-disable-next-line\n  }, [linkId]);\n\n  function getLink() {\n    linkRef.get().then(doc => {\n      setLink({ ...doc.data(),\n        id: doc.id\n      });\n    });\n  }\n\n  function handleAddVote() {\n    if (!user) {\n      props.history.push(\"/login\");\n    } else {\n      linkRef.get().then(doc => {\n        if (doc.exists) {\n          const previousVotes = doc.data().votes;\n          const vote = {\n            voteBy: {\n              id: user.uid,\n              name: user.displayName\n            }\n          };\n          const updatedVotes = [...previousVotes, vote];\n          const voteCount = updatedVotes.length;\n          linkRef.update({\n            votes: updatedVotes,\n            voteCount\n          });\n          setLink(prevState => ({ ...prevState,\n            votes: updatedVotes,\n            voteCount: voteCount\n          }));\n        }\n      });\n    }\n  }\n\n  function handleDeleteLink() {\n    linkRef.delete().then(() => {\n      console.log(`Document with ID ${link.id} deleted`);\n    }).catch(err => {\n      console.error(\"Error deleting document\", err);\n    });\n    props.history.push(\"/\");\n  }\n\n  function postedByAuthUser(link) {\n    return user && user.uid === link.postedBy.id;\n  }\n\n  async function openBrowser() {\n    await Browser.open({\n      url: link.url\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(IonPage, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(NavHeader, {\n    title: link && link.description,\n    option: link && postedByAuthUser(link),\n    icon: closeCircleOutline,\n    action: handleDeleteLink,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(IonContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 7\n    }\n  }, link && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(IonGrid, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonRow, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(IonCol, {\n    class: \"ion-text-center\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(LinkItem, {\n    link: link,\n    browser: openBrowser,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 19\n    }\n  }), /*#__PURE__*/React.createElement(IonButton, {\n    onClick: () => handleAddVote(),\n    size: \"small\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 19\n    }\n  }, \"Upvote\")))))));\n};\n\nexport default Link;","map":{"version":3,"sources":["C:/Users/shrey/Desktop/reactproject/Newsy/src/pages/Link.js"],"names":["React","firebase","Plugins","UserContext","IonPage","IonContent","IonGrid","IonRow","IonCol","IonButton","NavHeader","closeCircleOutline","LinkItem","Browser","Link","props","user","useContext","link","setLink","useState","linkId","match","params","linkRef","db","collection","doc","useEffect","getLink","get","then","data","id","handleAddVote","history","push","exists","previousVotes","votes","vote","voteBy","uid","name","displayName","updatedVotes","voteCount","length","update","prevState","handleDeleteLink","delete","console","log","catch","err","error","postedByAuthUser","postedBy","openBrowser","open","url","description"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport firebase from \"../firebase\";\r\nimport { Plugins } from \"@capacitor/core\";\r\nimport UserContext from \"../contexts/UserContext\";\r\nimport {\r\n  IonPage,\r\n  IonContent,\r\n  IonGrid,\r\n  IonRow,\r\n  IonCol,\r\n  IonButton,\r\n} from \"@ionic/react\";\r\nimport NavHeader from \"../components/Header/NavHeader\";\r\nimport { closeCircleOutline } from \"ionicons/icons\";\r\nimport LinkItem from \"../components/Link/LinkItem\";\r\n\r\nconst { Browser } = Plugins;\r\n\r\nconst Link = (props) => {\r\n  const { user } = React.useContext(UserContext);\r\n  const [link, setLink] = React.useState(null);\r\n  const linkId = props.match.params.linkId;\r\n  const linkRef = firebase.db.collection(\"links\").doc(linkId);\r\n\r\n  React.useEffect(() => {\r\n    getLink();\r\n    // eslint-disable-next-line\r\n  }, [linkId]);\r\n\r\n  function getLink() {\r\n    linkRef.get().then((doc) => {\r\n      setLink({ ...doc.data(), id: doc.id });\r\n    });\r\n  }\r\n\r\n  function handleAddVote() {\r\n    if (!user) {\r\n      props.history.push(\"/login\");\r\n    } else {\r\n      linkRef.get().then((doc) => {\r\n        if (doc.exists) {\r\n          const previousVotes = doc.data().votes;\r\n          const vote = { voteBy: { id: user.uid, name: user.displayName } };\r\n          const updatedVotes = [...previousVotes, vote];\r\n          const voteCount = updatedVotes.length;\r\n          linkRef.update({ votes: updatedVotes, voteCount });\r\n          setLink((prevState) => ({\r\n            ...prevState,\r\n            votes: updatedVotes,\r\n            voteCount: voteCount,\r\n          }));\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  function handleDeleteLink() {\r\n    linkRef\r\n      .delete()\r\n      .then(() => {\r\n        console.log(`Document with ID ${link.id} deleted`);\r\n      })\r\n      .catch((err) => {\r\n        console.error(\"Error deleting document\", err);\r\n      });\r\n    props.history.push(\"/\");\r\n  }\r\n\r\n  function postedByAuthUser(link) {\r\n    return user && user.uid === link.postedBy.id;\r\n  }\r\n\r\n  async function openBrowser() {\r\n    await Browser.open({\r\n      url: link.url,\r\n    });\r\n  }\r\n\r\n  return (\r\n    <IonPage>\r\n      <NavHeader\r\n        title={link && link.description}\r\n        option={link && postedByAuthUser(link)}\r\n        icon={closeCircleOutline}\r\n        action={handleDeleteLink}\r\n      />\r\n      <IonContent>\r\n        {link && (\r\n          <>\r\n            <IonGrid>\r\n              <IonRow>\r\n                <IonCol class=\"ion-text-center\">\r\n                  <LinkItem link={link} browser={openBrowser} />\r\n                  <IonButton onClick={() => handleAddVote()} size=\"small\">\r\n                    Upvote\r\n                  </IonButton>\r\n                </IonCol>\r\n              </IonRow>\r\n            </IonGrid>\r\n          </>\r\n        )}\r\n      </IonContent>\r\n    </IonPage>\r\n  );\r\n};\r\n\r\nexport default Link;\r\n"]},"metadata":{},"sourceType":"module"}