{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\shrey\\\\Desktop\\\\reactproject\\\\Newsy\\\\src\\\\components\\\\Link\\\\LinkComment.js\";\nimport React from \"react\";\nimport UserContext from \"../../contexts/UserContext\";\nimport firebase from \"../../firebase\";\nimport CommentModal from \"./CommentModal\";\nimport { IonCard, IonCardContent, IonList, IonItem, IonLabel, IonButton } from \"@ionic/react\";\nimport { formatDistanceToNow } from \"date-fns\";\n\nconst LinkComment = ({\n  comment,\n  link,\n  setLink\n}) => {\n  const {\n    user\n  } = React.useContext(UserContext);\n  const [showModal, setShowModal] = React.useState(false);\n  const postedByAuthUser = user && user.uid === comment.postedBy.id;\n\n  function handleCloseModal() {\n    setShowModal(false);\n  }\n\n  function handleEditComment(commentText) {\n    const linkref = firebase.db.collection(\"links\").doc(link.id);\n    linkref.get().then(doc => {\n      if (doc.exists) {\n        const previousComments = doc.data().comments;\n        const newComment = {\n          postedBy: {\n            id: user.uid,\n            name: user.displayName\n          },\n          created: Date.now(),\n          text: commentText\n        };\n        const updatedComments = previousComments.map(item => item.created === comment.created ? newComment : item);\n        linkref.update({\n          comments: updatedComments\n        });\n        setLink(prevState => ({ ...prevState,\n          comments: updatedComments\n        }));\n      }\n    });\n    setShowModal(false);\n  }\n\n  function handleDeleteComment() {\n    const linkRef = firebase.db.collection(\"links\").doc(link.id);\n    linkRef.get().then(doc => {\n      if (doc.exists) {\n        const previousComments = doc.data().comments;\n        const updatedComments = previousComments.filter(item => item.created !== comment.created);\n        linkRef.update({\n          comments: updatedComments\n        });\n        setLink(prevState => ({ ...prevState,\n          comments: updatedComments\n        }));\n      }\n    });\n  }\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(CommentModal, {\n    isOpen: showModal,\n    title: \"Edit Comment\",\n    sendAction: handleEditComment,\n    closeAction: handleCloseModal,\n    comment: comment,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(IonCard, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(IonCardContent, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(IonList, {\n    lines: \"none\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(IonItem, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(IonLabel, {\n    class: \"ion-text-wrap\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 15\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    style: {\n      alignItems: \"center\",\n      fontSize: \"0.8rem\",\n      fontWeight: \"normal\"\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 17\n    }\n  }, comment.postedBy.name, \" \", \" | \", formatDistanceToNow(comment.created)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"ion-padding-vertical\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 17\n    }\n  }, comment.text), postedByAuthUser && /*#__PURE__*/React.createElement(IonButton, {\n    size: \"small\",\n    onClick: () => setShowModal(true),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 19\n    }\n  }, \"Edit\"), postedByAuthUser && /*#__PURE__*/React.createElement(IonButton, {\n    size: \"small\",\n    onClick: () => handleDeleteComment(comment),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 19\n    }\n  }, \"Delete\")))))));\n};\n\nexport default LinkComment;","map":{"version":3,"sources":["C:/Users/shrey/Desktop/reactproject/Newsy/src/components/Link/LinkComment.js"],"names":["React","UserContext","firebase","CommentModal","IonCard","IonCardContent","IonList","IonItem","IonLabel","IonButton","formatDistanceToNow","LinkComment","comment","link","setLink","user","useContext","showModal","setShowModal","useState","postedByAuthUser","uid","postedBy","id","handleCloseModal","handleEditComment","commentText","linkref","db","collection","doc","get","then","exists","previousComments","data","comments","newComment","name","displayName","created","Date","now","text","updatedComments","map","item","update","prevState","handleDeleteComment","linkRef","filter","alignItems","fontSize","fontWeight"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport UserContext from \"../../contexts/UserContext\";\r\nimport firebase from \"../../firebase\";\r\nimport CommentModal from \"./CommentModal\";\r\nimport {\r\n  IonCard,\r\n  IonCardContent,\r\n  IonList,\r\n  IonItem,\r\n  IonLabel,\r\n  IonButton,\r\n} from \"@ionic/react\";\r\nimport { formatDistanceToNow } from \"date-fns\";\r\n\r\nconst LinkComment = ({ comment, link, setLink }) => {\r\n  const { user } = React.useContext(UserContext);\r\n  const [showModal, setShowModal] = React.useState(false);\r\n\r\n  const postedByAuthUser = user && user.uid === comment.postedBy.id;\r\n\r\n  function handleCloseModal() {\r\n    setShowModal(false);\r\n  }\r\n\r\n  function handleEditComment(commentText) {\r\n    const linkref = firebase.db.collection(\"links\").doc(link.id);\r\n    linkref.get().then((doc) => {\r\n      if (doc.exists) {\r\n        const previousComments = doc.data().comments;\r\n        const newComment = {\r\n          postedBy: { id: user.uid, name: user.displayName },\r\n          created: Date.now(),\r\n          text: commentText,\r\n        };\r\n        const updatedComments = previousComments.map((item) =>\r\n          item.created === comment.created ? newComment : item\r\n        );\r\n        linkref.update({ comments: updatedComments });\r\n        setLink((prevState) => ({\r\n          ...prevState,\r\n          comments: updatedComments,\r\n        }));\r\n      }\r\n    });\r\n    setShowModal(false);\r\n  }\r\n\r\n  function handleDeleteComment() {\r\n    const linkRef = firebase.db.collection(\"links\").doc(link.id);\r\n    linkRef.get().then((doc) => {\r\n      if (doc.exists) {\r\n        const previousComments = doc.data().comments;\r\n        const updatedComments = previousComments.filter(\r\n          (item) => item.created !== comment.created\r\n        );\r\n        linkRef.update({ comments: updatedComments });\r\n        setLink((prevState) => ({\r\n          ...prevState,\r\n          comments: updatedComments,\r\n        }));\r\n      }\r\n    });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <CommentModal\r\n        isOpen={showModal}\r\n        title=\"Edit Comment\"\r\n        sendAction={handleEditComment}\r\n        closeAction={handleCloseModal}\r\n        comment={comment}\r\n      />\r\n      <IonCard>\r\n        <IonCardContent>\r\n          <IonList lines=\"none\">\r\n            <IonItem>\r\n              <IonLabel class=\"ion-text-wrap\">\r\n                <p\r\n                  style={{\r\n                    alignItems: \"center\",\r\n                    fontSize: \"0.8rem\",\r\n                    fontWeight: \"normal\",\r\n                  }}\r\n                >\r\n                  {comment.postedBy.name} {\" | \"}\r\n                  {formatDistanceToNow(comment.created)}\r\n                </p>\r\n                <div className=\"ion-padding-vertical\">{comment.text}</div>\r\n                {postedByAuthUser && (\r\n                  <IonButton size=\"small\" onClick={() => setShowModal(true)}>\r\n                    Edit\r\n                  </IonButton>\r\n                )}\r\n\r\n                {postedByAuthUser && (\r\n                  <IonButton\r\n                    size=\"small\"\r\n                    onClick={() => handleDeleteComment(comment)}\r\n                  >\r\n                    Delete\r\n                  </IonButton>\r\n                )}\r\n              </IonLabel>\r\n            </IonItem>\r\n          </IonList>\r\n        </IonCardContent>\r\n      </IonCard>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LinkComment;\r\n"]},"metadata":{},"sourceType":"module"}