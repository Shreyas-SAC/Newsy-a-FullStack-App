{"ast":null,"code":"import _objectSpread from\"C:\\\\Users\\\\shrey\\\\Desktop\\\\ReactProject\\\\Newsy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:\\\\Users\\\\shrey\\\\Desktop\\\\ReactProject\\\\Newsy\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React from\"react\";import UserContext from\"../../contexts/UserContext\";import firebase from\"../../firebase\";import CommentModal from\"./CommentModal\";import{IonCard,IonCardContent,IonList,IonItem,IonLabel,IonButton}from\"@ionic/react\";import{formatDistanceToNow}from\"date-fns\";var LinkComment=function LinkComment(_ref){var comment=_ref.comment,link=_ref.link,setLink=_ref.setLink;var _React$useContext=React.useContext(UserContext),user=_React$useContext.user;var _React$useState=React.useState(false),_React$useState2=_slicedToArray(_React$useState,2),showModal=_React$useState2[0],setShowModal=_React$useState2[1];var postedByAuthUser=user&&user.uid===comment.postedBy.id;function handleCloseModal(){setShowModal(false);}function handleEditComment(commentText){var linkref=firebase.db.collection(\"links\").doc(link.id);linkref.get().then(function(doc){if(doc.exists){var previousComments=doc.data().comments;var newComment={postedBy:{id:user.uid,name:user.displayName},created:Date.now(),text:commentText};var updatedComments=previousComments.map(function(item){return item.created===comment.created?newComment:item;});linkref.update({comments:updatedComments});setLink(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{comments:updatedComments});});}});setShowModal(false);}function handleDeleteComment(){var linkRef=firebase.db.collection(\"links\").doc(link.id);linkRef.get().then(function(doc){if(doc.exists){var previousComments=doc.data().comments;var updatedComments=previousComments.filter(function(item){return item.created!==comment.created;});linkRef.update({comments:updatedComments});setLink(function(prevState){return _objectSpread(_objectSpread({},prevState),{},{comments:updatedComments});});}});}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(CommentModal,{isOpen:showModal,title:\"Edit Comment\",sendAction:handleEditComment,closeAction:handleCloseModal,comment:comment}),/*#__PURE__*/React.createElement(IonCard,null,/*#__PURE__*/React.createElement(IonCardContent,null,/*#__PURE__*/React.createElement(IonList,{lines:\"none\"},/*#__PURE__*/React.createElement(IonItem,null,/*#__PURE__*/React.createElement(IonLabel,{class:\"ion-text-wrap\"},/*#__PURE__*/React.createElement(\"p\",{style:{alignItems:\"center\",fontSize:\"0.8rem\",fontWeight:\"normal\"}},comment.postedBy.name,\" \",\" | \",formatDistanceToNow(comment.created)),/*#__PURE__*/React.createElement(\"div\",{className:\"ion-padding-vertical\"},comment.text),postedByAuthUser&&/*#__PURE__*/React.createElement(IonButton,{size:\"small\",onClick:function onClick(){return setShowModal(true);}},\"Edit\"),postedByAuthUser&&/*#__PURE__*/React.createElement(IonButton,{size:\"small\",onClick:function onClick(){return handleDeleteComment(comment);}},\"Delete\")))))));};export default LinkComment;","map":{"version":3,"sources":["C:/Users/shrey/Desktop/ReactProject/Newsy/src/components/Link/LinkComment.js"],"names":["React","UserContext","firebase","CommentModal","IonCard","IonCardContent","IonList","IonItem","IonLabel","IonButton","formatDistanceToNow","LinkComment","comment","link","setLink","useContext","user","useState","showModal","setShowModal","postedByAuthUser","uid","postedBy","id","handleCloseModal","handleEditComment","commentText","linkref","db","collection","doc","get","then","exists","previousComments","data","comments","newComment","name","displayName","created","Date","now","text","updatedComments","map","item","update","prevState","handleDeleteComment","linkRef","filter","alignItems","fontSize","fontWeight"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport UserContext from \"../../contexts/UserContext\";\r\nimport firebase from \"../../firebase\";\r\nimport CommentModal from \"./CommentModal\";\r\nimport {\r\n  IonCard,\r\n  IonCardContent,\r\n  IonList,\r\n  IonItem,\r\n  IonLabel,\r\n  IonButton,\r\n} from \"@ionic/react\";\r\nimport { formatDistanceToNow } from \"date-fns\";\r\n\r\nconst LinkComment = ({ comment, link, setLink }) => {\r\n  const { user } = React.useContext(UserContext);\r\n  const [showModal, setShowModal] = React.useState(false);\r\n\r\n  const postedByAuthUser = user && user.uid === comment.postedBy.id;\r\n\r\n  function handleCloseModal() {\r\n    setShowModal(false);\r\n  }\r\n\r\n  function handleEditComment(commentText) {\r\n    const linkref = firebase.db.collection(\"links\").doc(link.id);\r\n    linkref.get().then((doc) => {\r\n      if (doc.exists) {\r\n        const previousComments = doc.data().comments;\r\n        const newComment = {\r\n          postedBy: { id: user.uid, name: user.displayName },\r\n          created: Date.now(),\r\n          text: commentText,\r\n        };\r\n        const updatedComments = previousComments.map((item) =>\r\n          item.created === comment.created ? newComment : item\r\n        );\r\n        linkref.update({ comments: updatedComments });\r\n        setLink((prevState) => ({\r\n          ...prevState,\r\n          comments: updatedComments,\r\n        }));\r\n      }\r\n    });\r\n    setShowModal(false);\r\n  }\r\n\r\n  function handleDeleteComment() {\r\n    const linkRef = firebase.db.collection(\"links\").doc(link.id);\r\n    linkRef.get().then((doc) => {\r\n      if (doc.exists) {\r\n        const previousComments = doc.data().comments;\r\n        const updatedComments = previousComments.filter(\r\n          (item) => item.created !== comment.created\r\n        );\r\n        linkRef.update({ comments: updatedComments });\r\n        setLink((prevState) => ({\r\n          ...prevState,\r\n          comments: updatedComments,\r\n        }));\r\n      }\r\n    });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <CommentModal\r\n        isOpen={showModal}\r\n        title=\"Edit Comment\"\r\n        sendAction={handleEditComment}\r\n        closeAction={handleCloseModal}\r\n        comment={comment}\r\n      />\r\n      <IonCard>\r\n        <IonCardContent>\r\n          <IonList lines=\"none\">\r\n            <IonItem>\r\n              <IonLabel class=\"ion-text-wrap\">\r\n                <p\r\n                  style={{\r\n                    alignItems: \"center\",\r\n                    fontSize: \"0.8rem\",\r\n                    fontWeight: \"normal\",\r\n                  }}\r\n                >\r\n                  {comment.postedBy.name} {\" | \"}\r\n                  {formatDistanceToNow(comment.created)}\r\n                </p>\r\n                <div className=\"ion-padding-vertical\">{comment.text}</div>\r\n                {postedByAuthUser && (\r\n                  <IonButton size=\"small\" onClick={() => setShowModal(true)}>\r\n                    Edit\r\n                  </IonButton>\r\n                )}\r\n\r\n                {postedByAuthUser && (\r\n                  <IonButton\r\n                    size=\"small\"\r\n                    onClick={() => handleDeleteComment(comment)}\r\n                  >\r\n                    Delete\r\n                  </IonButton>\r\n                )}\r\n              </IonLabel>\r\n            </IonItem>\r\n          </IonList>\r\n        </IonCardContent>\r\n      </IonCard>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LinkComment;\r\n"]},"metadata":{},"sourceType":"module"}